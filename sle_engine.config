# ==============================================================================
# SLE Engine Configuration File
# CUDA-Accelerated State Load Estimator
# ==============================================================================
#
# This file configures the SLE Engine behavior, capacity, and performance.
# Lines starting with # or ; are comments.
# Format: key = value
#
# To apply changes, either:
# 1. Restart the engine, or
# 2. Call sle_ReloadConfig() if supported
#
# ==============================================================================

# ------------------------------------------------------------------------------
# [device] - CUDA Device Settings
# ------------------------------------------------------------------------------
[device]
# CUDA device ID (0 = first GPU, 1 = second GPU, etc.)
# Use nvidia-smi to list available devices
device_id = 0

# ------------------------------------------------------------------------------
# [capacity] - Network Size Limits (NFR-01)
# ------------------------------------------------------------------------------
# Pre-allocated memory for network elements.
# Larger values use more GPU memory but support bigger networks.
# NFR-01 Target: 200,000 buses and 2,000,000 measurements
# ------------------------------------------------------------------------------
[capacity]
# Maximum number of buses (substations, nodes)
max_buses = 200000

# Maximum number of branches (lines, transformers)
max_branches = 400000

# Maximum number of measurements (telemetry points)
max_measurements = 2000000

# Maximum number of switching devices (breakers, switches)
max_switching_devices = 100000

# ------------------------------------------------------------------------------
# [solver] - WLS Solver Settings
# ------------------------------------------------------------------------------
# Controls the Weighted Least Squares estimation algorithm
# ------------------------------------------------------------------------------
[solver]
# FR-17: Enable robust estimation using Huber M-estimator
# Reduces influence of outliers/bad data without full rejection
enable_robust_estimation = false

# Huber threshold parameter (gamma)
# Measurements with normalized residuals > gamma get reduced weight
# Typical range: 1.0 to 3.0
huber_gamma = 1.5

# Convergence tolerance for WLS iterations
# Solver stops when max state mismatch < tolerance
# Smaller = more accurate but slower
convergence_tolerance = 1e-4

# FR-11: Real-time mode settings
# Maximum iterations allowed before returning result
max_realtime_iterations = 5

# Maximum wall-clock time for real-time estimation [milliseconds]
realtime_time_limit_ms = 20.0

# FR-12: Precision mode settings  
# Maximum iterations for offline/precision analysis
max_precision_iterations = 100

# Default initialization method
# true = flat start (V=1.0, theta=0)
# false = hot start (use previous solution)
use_flat_start_default = false

# ------------------------------------------------------------------------------
# [performance] - GPU Performance Tuning
# ------------------------------------------------------------------------------
# Advanced settings for CUDA kernel optimization
# ------------------------------------------------------------------------------
[performance]
# Enable detailed CUDA event timing for profiling
# Adds small overhead but provides timing breakdowns
enable_profiling = false

# FR-09: Use CUDA Graphs for iteration sequence
# Captures kernel sequence and replays with minimal overhead
# Recommended: true for production, false for debugging
use_cuda_graphs = true

# CUDA kernel block sizes (threads per block)
# Must be power of 2, range: 32-1024
# Standard kernels (power flow, measurement function)
block_size_standard = 256

# Reduction kernels (objective function, convergence check)
block_size_reduction = 512

# ------------------------------------------------------------------------------
# [numerical] - Numerical Precision and Limits
# ------------------------------------------------------------------------------
[numerical]
# NFR-04: Use double precision (fp64) instead of single precision (fp32)
# fp64 is more accurate but ~2x slower on consumer GPUs
# Recommended: false for real-time, true for offline analysis
use_double_precision = false

# Voltage magnitude limits [per unit]
# State update clamps voltage within these bounds
# Prevents divergence from unrealistic values
voltage_min_pu = 0.5
voltage_max_pu = 1.5

# ------------------------------------------------------------------------------
# [bad_data] - Bad Data Detection Settings (FR-15)
# ------------------------------------------------------------------------------
# Controls identification and handling of measurement errors
# ------------------------------------------------------------------------------
[bad_data]
# Normalized residual threshold for bad data identification
# Measurements with |r|/sigma > threshold are flagged
# 3.0 corresponds to 99.7% confidence (3-sigma rule)
bad_data_threshold = 3.0

# Automatically reject identified bad data in subsequent iterations
# true = re-run estimation without flagged measurements
# false = only flag, don't reject
auto_bad_data_rejection = false

# ==============================================================================
# End of Configuration
# ==============================================================================
